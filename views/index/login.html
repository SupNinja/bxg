<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>学IT - 后台管理系统</title>
    <?php include "./views/layout/style.html"; ?>
</head>
<body>
    <!-- 登录 -->
    <div class="login">
        <div class="login-wrap">
            <div class="avatar">
                <img src="./uploads/monkey.png" class="img-circle" alt="">
            </div>
            <form id="loginForm" action="" class="col-xs-offset-1 col-xs-10">
                <div class="input-group input-group-lg">
                    <span class="input-group-addon">
                        <i class="fa fa-user"></i>
                    </span>
                    <input type="text" name="tc_name" class="form-control" placeholder="用户名">
                </div>
                <div class="input-group input-group-lg">
                    <span class="input-group-addon">
                        <i class="fa fa-key"></i>
                    </span>
                    <input type="password" name="tc_pass" class="form-control" placeholder="密码">
                </div>
                <button type="submit" class="btn btn-lg btn-primary btn-block">登 录</button>
            </form>
        </div>
    </div>
    
    <?php include "./views/layout/scripts.html"; ?>
    <script>
        //提供用户输入界面，用户输入登录信息，将用户的登录信息发送到服务端
        //由服务端验证是否合法

        //用户提交表单时将数据发送到服务端
        //使用submit事件，当表单提交时触发


        $("#loginForm").on("submit",function(){
            var formData=$(this).serialize();
            //接口文档中给的url和我们的服务器域名不同源
            //跨域问题解决：配置服务器apache反向代理
            //当我们访问/api/login
            //实际访问的是自己本地的apache
            //Apache发现你的地址上有api这个字符
            //会自动将请求转移到http://api.botue.com
            $.ajax({
                type:"post",
                url:"/api/login",
                data:formData,
                success: function(info){
                    if(info.code==200){
                        alert("登录成功");
                        //将服务器返回的用户信息存储到cookie中，方便其他页面使用
                        //cookie只能用来存储字符串
                        $.cookie("loginfo",JSON.stringify(info.result));
                        //登录成功后跳转到首页
                        location.href="/";
                    }
                }
            })
            //阻止默认行为（页面不会被刷新）
            return false;
        })
    </script>
</body>
</html>